<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EITBAL - ÙˆØ±ÙˆØ¯</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø´Ù…Ø§ Ú©Ø§Ù…Ù„ Ø­ÙØ¸ Ù…ÛŒâ€ŒØ´Ù† */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            direction: rtl;
            font-family: 'Orbitron', sans-serif;
            background-color: #000;
            color: #FFD700;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        .particles-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; pointer-events: none;
        }

        .particle {
            position: absolute;
            bottom: -20px; border-radius: 50%; opacity: 0;
            animation: rise-and-fade linear infinite;
        }

        .particle.gold { background: #FFD700; box-shadow: 0 0 10px #FFD700; }
        .particle.white { background: #FFFFFF; box-shadow: 0 0 10px #FFFFFF; }

        @keyframes rise-and-fade {
            0% { transform: translateY(0) scale(0.3); opacity: 0; }
            15% { opacity: 0.8; }
            85% { opacity: 0.8; }
            100% { transform: translateY(-115vh) scale(1.2); opacity: 0; }
        }

        .ball-wrapper {
            position: relative; width: 620px; height: 620px;
            display: flex; justify-content: center; align-items: center; z-index: 10;
        }

        .glass-ball {
            position: absolute; width: 100%; height: 100%; border-radius: 50%;
            background: rgba(10, 10, 10, 0.7);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 100 100'%3E%3Cpath d='M50 0 L93.3 25 L93.3 75 L50 100 L6.7 75 L6.7 25 Z' fill='none' stroke='rgba(255, 215, 0, 0.15)' stroke-width='1'/%3E%3C/svg%3E");
            background-size: 140px 140px;
            -webkit-mask-image: radial-gradient(circle, black 35%, transparent 95%);
            mask-image: radial-gradient(circle, black 35%, transparent 95%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 0 80px rgba(0, 0, 0, 0.8);
        }

        .content {
            position: relative; z-index: 20; text-align: center;
            width: 100%; max-width: 380px;
        }

        .logo {
            font-size: 4.2rem; font-weight: 800; margin-bottom: 30px;
            background: linear-gradient(to bottom, #FFD700, #FFF, #FFD700);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.5));
        }

        .input-box { position: relative; margin-bottom: 25px; }
        .input-box span.prefix {
            position: absolute; left: 20px; top: 50%; transform: translateY(-50%);
            color: rgba(255, 215, 0, 0.6); font-size: 1.1rem; font-weight: bold;
            border-right: 1px solid rgba(255, 215, 0, 0.2); padding-right: 10px; z-index: 5;
        }
        .input-box .flag-icon {
            position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
            font-size: 1.5rem; z-index: 5;
        }

        input[type="tel"], input[type="text"] {
            width: 100%; padding: 20px 60px 20px 85px; border-radius: 40px;
            background: rgba(0, 0, 0, 0.8); border: 1px solid rgba(255, 215, 0, 0.3);
            color: #FFD700; font-size: 1.3rem; outline: none; text-align: left; letter-spacing: 2px;
        }
        input[type="tel"]:focus, input[type="text"]:focus {
            background: rgba(0, 0, 0, 0.9); border-color: rgba(255, 215, 0, 0.6);
        }

        .verification-box {
            position: relative; margin-bottom: 25px; display: none;
        }
        .verification-box.active { display: block; animation: fadeIn 0.3s ease; }
        .verification-box .code-icon {
            position: absolute; right: 20px; top: 50%; transform: translateY(-50%);
            font-size: 1.5rem; z-index: 5;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .gender-options { display: flex; justify-content: center; gap: 45px; margin-bottom: 35px; }
        .gender-option { font-size: 2.8rem; cursor: pointer; opacity: 0.3; transition: 0.4s; }
        .gender-option.active { opacity: 1; transform: scale(1.3); text-shadow: 0 0 25px #FFD700; }

        .main-btn {
            width: 100%; padding: 22px; border-radius: 45px;
            background: linear-gradient(45deg, #FFD700, #FFA500); border: none;
            color: #000; font-weight: 800; font-size: 1.4rem; cursor: pointer;
            box-shadow: 0 0 35px rgba(255, 215, 0, 0.5); margin-bottom: 15px; transition: 0.3s;
        }
        .main-btn:hover { transform: scale(1.02); box-shadow: 0 0 50px rgba(255, 215, 0, 0.8); }
        .main-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .mode-switch { display: flex; justify-content: center; gap: 50px; }
        .mode-btn {
            font-size: 1.1rem; color: #FFD700; opacity: 0.4; cursor: pointer;
            transition: 0.3s; border-bottom: 2px solid transparent; padding-bottom: 5px;
        }
        .mode-btn.active { opacity: 1; border-bottom: 2px solid #FFD700; text-shadow: 0 0 10px #FFD700; }

        .resend-code {
            margin-top: 10px; font-size: 0.9rem; color: rgba(255, 215, 0, 0.6);
            cursor: pointer; transition: 0.3s;
        }
        .resend-code:hover { color: #FFD700; text-shadow: 0 0 10px #FFD700; }
        .timer { color: rgba(255, 255, 255, 0.5); font-size: 0.9rem; margin-right: 5px; }

        .test-account { display: flex; justify-content: center; margin-bottom: 15px; }
        .test-btn {
            background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3);
            color: #FFD700; padding: 10px 25px; border-radius: 40px; font-size: 1rem;
            font-weight: 700; cursor: pointer; transition: 0.3s;
            display: flex; align-items: center; gap: 10px;
        }
        .test-btn:hover {
            background: rgba(255, 215, 0, 0.2); border-color: #FFD700;
            transform: scale(1.05); box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        /* Ù¾ÛŒØ§Ù… toast */
        .toast {
            position: fixed; top: 30px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9); border-radius: 50px; padding: 15px 30px;
            font-size: 1rem; z-index: 10000; backdrop-filter: blur(10px);
            animation: slideDown 0.3s ease;
        }
        .toast.success { border: 1px solid #FFD700; color: #FFD700; }
        .toast.error { border: 1px solid #FF4444; color: #FF4444; }

        @keyframes slideDown {
            from { opacity: 0; transform: translateX(-50%) translateY(-50px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        @keyframes slideUp {
            from { opacity: 1; transform: translateX(-50%) translateY(0); }
            to { opacity: 0; transform: translateX(-50%) translateY(-50px); }
        }
    </style>
</head>
<body>

<div class="particles-container" id="particles"></div>

<div class="ball-wrapper">
    <div class="glass-ball"></div>
    
    <div class="content">
        <h1 class="logo">EITBAL</h1>
        
        <!-- ÙÛŒÙ„Ø¯ Ø´Ù…Ø§Ø±Ù‡ Ù…ÙˆØ¨Ø§ÛŒÙ„ -->
        <div class="input-box">
            <span class="flag-icon">ğŸ‡®ğŸ‡·</span>
            <span class="prefix">+98</span>
            <input type="tel" id="phone" placeholder="9123456789" maxlength="10" inputmode="numeric" autocomplete="off">
        </div>

        <!-- Ø¯Ú©Ù…Ù‡ Ø´Ù…Ø§Ø±Ù‡ ØªØ³Øª -->
        <div class="test-account">
            <button class="test-btn" onclick="fillTestNumber()">
                <span>ğŸ§ª</span>
                <span>Ø´Ù…Ø§Ø±Ù‡ ØªØ³Øª: 9120000000</span>
            </button>
        </div>

        <!-- ÙÛŒÙ„Ø¯ Ú©Ø¯ ØªØ£ÛŒÛŒØ¯ -->
        <div class="verification-box" id="verificationBox">
            <span class="code-icon">ğŸ”‘</span>
            <input type="text" id="verifyCode" placeholder="Ú©Ø¯ ØªØ£ÛŒÛŒØ¯ Û´ Ø±Ù‚Ù…ÛŒ" maxlength="4" inputmode="numeric" autocomplete="off">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 8px;">
                <span class="resend-code" onclick="resendCode()">Ø§Ø±Ø³Ø§Ù„ Ù…Ø¬Ø¯Ø¯ Ú©Ø¯</span>
                <span class="timer" id="timerText">00:30</span>
            </div>
        </div>

        <div class="gender-options">
            <div class="gender-option active" onclick="setGender(this, 'male')">ğŸ‘¨</div>
            <div class="gender-option" onclick="setGender(this, 'female')">ğŸ‘©</div>
        </div>

        <button class="main-btn" id="main-submit" onclick="handleSubmit()">âš½ ÙˆØ±ÙˆØ¯</button>

        <div class="mode-switch">
            <div class="mode-btn active" id="btn-login" onclick="setMode('login')">ÙˆØ±ÙˆØ¯</div>
            <div class="mode-btn" id="btn-register" onclick="setMode('register')">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</div>
        </div>
    </div>
</div>

<script>
    // === Ø³ÛŒØ³ØªÙ… Ø°Ø±Ø§Øª ===
    const container = document.getElementById('particles');
    for (let i = 0; i < 100; i++) {
        const p = document.createElement('div');
        p.className = `particle ${Math.random() > 0.4 ? 'gold' : 'white'}`;
        p.style.width = p.style.height = (Math.random() * 3 + 1) + 'px';
        p.style.left = Math.random() * 100 + '%';
        p.style.animationDuration = (Math.random() * 6 + 4) + 's';
        p.style.animationDelay = -(Math.random() * 10) + 's';
        container.appendChild(p);
    }

    // === Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ===
    const TEST_PHONE = "9120000000";
    const TEST_CODE = "1234";
    let currentMode = 'login';
    let selectedGender = 'male';
    let timerInterval;
    let timeLeft = 30;

    // === ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ===
    function showMessage(msg, type = 'success') {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        toast.textContent = msg;
        document.body.appendChild(toast);
        setTimeout(() => {
            toast.style.animation = 'slideUp 0.3s ease';
            setTimeout(() => toast.remove(), 300);
        }, 2500);
    }

    function fillTestNumber() {
        document.getElementById('phone').value = TEST_PHONE;
        showMessage('âœ… Ø´Ù…Ø§Ø±Ù‡ ØªØ³Øª ÙˆØ§Ø±Ø¯ Ø´Ø¯');
    }

    function setGender(el, gender) {
        selectedGender = gender;
        document.querySelectorAll('.gender-option').forEach(opt => opt.classList.remove('active'));
        el.classList.add('active');
    }

    function setMode(mode) {
        currentMode = mode;
        document.getElementById('main-submit').innerHTML = mode === 'login' ? 'âš½ ÙˆØ±ÙˆØ¯' : 'ğŸ“ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…';
        document.getElementById('btn-login').classList.toggle('active', mode === 'login');
        document.getElementById('btn-register').classList.toggle('active', mode === 'register');
        document.getElementById('verificationBox').classList.toggle('active', mode === 'register');
        
        if (mode === 'register') startTimer();
        else clearTimer();
    }

    function startTimer() {
        clearInterval(timerInterval);
        timeLeft = 30;
        updateTimer();
        timerInterval = setInterval(() => {
            timeLeft--;
            updateTimer();
            if (timeLeft <= 0) clearInterval(timerInterval);
        }, 1000);
    }

    function updateTimer() {
        const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
        const s = (timeLeft % 60).toString().padStart(2, '0');
        document.getElementById('timerText').textContent = `${m}:${s}`;
    }

    function clearTimer() {
        clearInterval(timerInterval);
        document.getElementById('timerText').textContent = '00:30';
    }

    function resendCode() {
        showMessage('âœ… Ú©Ø¯ Ø¬Ø¯ÛŒØ¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯');
        startTimer();
    }

    // === âœ… Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯ÛŒÙ† ÙˆØ§Ù‚Ø¹ÛŒ ===
    function handleSubmit() {
        const phone = document.getElementById('phone').value.trim();
        const code = document.getElementById('verifyCode').value.trim();

        // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
        if (!phone || phone.length !== 10) {
            showMessage('âŒ Ø´Ù…Ø§Ø±Ù‡ Û±Û° Ø±Ù‚Ù…ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
            return;
        }

        // Ø­Ø§Ù„Øª ÙˆØ±ÙˆØ¯
        if (currentMode === 'login') {
            if (phone !== TEST_PHONE) {
                showMessage('âŒ ÙÙ‚Ø· Ø´Ù…Ø§Ø±Ù‡ ØªØ³Øª Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„ Ø§Ø³Øª', 'error');
                return;
            }
            
            // âœ… Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage (Ø³Ø§Ø®ØªØ§Ø± royal_store)
            saveUserData(phone, selectedGender);
            showMessage('âœ… ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚! Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªÙ‚Ø§Ù„...');
            
            setTimeout(() => {
                window.location.replace('./app.html');
            }, 1000);
        }
        
        // Ø­Ø§Ù„Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
        else {
            if (!code || code !== TEST_CODE) {
                showMessage('âŒ Ú©Ø¯ Û±Û²Û³Û´ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            saveUserData(phone, selectedGender);
            showMessage('âœ… Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù…ÙˆÙÙ‚! Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªÙ‚Ø§Ù„...');
            
            setTimeout(() => {
                window.location.replace('./app.html');
            }, 1000);
        }
    }

    // === âœ… Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡ Ú©Ø§Ø±Ø¨Ø± ===
    function saveUserData(phone, gender) {
        const userData = {
            user: {
                id: 'user_' + Date.now(),
                phone: phone,
                name: gender === 'male' ? 'Ú©Ø§Ø±Ø¨Ø± Ø¢Ù‚Ø§' : 'Ú©Ø§Ø±Ø¨Ø± Ø®Ø§Ù†Ù…',
                gender: gender,
                joinDate: new Date().toISOString(),
                isPremium: false,
                premiumExpiry: null
            },
            stats: {
                streak: 1,
                coins: 1000,
                energy: 1000,
                maxEnergy: 1000,
                points: 0,
                correctPredictions: 0,
                totalPredictions: 0,
                tapCount: 0,
                todayTap: 0,
                invites: 0
            },
            inventory: {
                frames: [],
                activeFrame: null,
                skins: [],
                activeSkin: null,
                boosts: []
            },
            predictions: [],
            team: [],
            votes: {}
        };
        
        localStorage.setItem('royal_store', JSON.stringify(userData));
        localStorage.setItem('eitabal_gender', gender);
        
        console.log('âœ… User data saved:', userData);
    }

    // === Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ÙˆØ±ÙˆØ¯ÛŒ ===
    document.getElementById('phone').addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);
    });
    
    document.getElementById('verifyCode')?.addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9]/g, '').slice(0, 4);
    });

    // === Ø¨Ø±Ø±Ø³ÛŒ Ø§Ú¯Ø± Ù‚Ø¨Ù„Ø§Ù‹ Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ ===
    (function checkExistingAuth() {
        const royalStore = localStorage.getItem('royal_store');
        if (royalStore) {
            try {
                const data = JSON.parse(royalStore);
                if (data.user && data.user.phone) {
                    // Ù‚Ø¨Ù„Ø§Ù‹ Ù„Ø§Ú¯ÛŒÙ† Ú©Ø±Ø¯Ù‡ØŒ Ø¨Ø±Ùˆ Ø¨Ù‡ app
                    window.location.replace('./app.html');
                }
            } catch (e) {
                localStorage.removeItem('royal_store');
            }
        }
    })();
</script>

</body>
</html>
